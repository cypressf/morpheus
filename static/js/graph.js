// Generated by CoffeeScript 1.3.3
(function() {
  var Sleep, User, chartC, chartO, mainUser, randint, updateOverview;

  randint = function(a, b) {
    return Math.floor(Math.random() * (b - 1) + a);
  };

  User = (function() {

    function User(name) {
      this.name = name;
      this.sleeps = [];
    }

    return User;

  })();

  Sleep = (function() {

    function Sleep(start, end) {
      this.start = start;
      this.end = end;
      this.start = new Date(this.start);
      this.end = new Date(this.end);
    }

    return Sleep;

  })();

  mainUser = new User('Gomez');

  chartO = d3.select("#overview-chart");

  chartC = d3.select("#current-chart");

  updateOverview = function() {
    return chartO.selectAll("rect").data(mainUser.sleeps).enter().append("rect").attr("x", function(d, i) {
      return i * 6;
    }).attr("y", function(d, i) {
      return d.start.getHours() * 10;
    }).attr("height", function(d, i) {
      return (d.end.getHours() - d.start.getHours()) * 10;
    }).attr("width", 5);
  };

  window.morpheus.getDataForUser((function(response) {
    var newSleep, s, _i, _len;
    for (_i = 0, _len = response.length; _i < _len; _i++) {
      s = response[_i];
      newSleep = new Sleep(s.start, s.end);
      mainUser.sleeps.push(newSleep);
      updateOverview();
    }
    return console.log(response);
  }), 'Gomez');

  'for i in [1..200]\n    sTime = randint 0, 5\n    eTime = sTime + randint 3, 9\n    s = new Sleep mainUser, sTime, eTime\n    mainUser.sleeps.push s';


  'chartC.selectAll("rect")\n    .data(mainUser.sleeps[-7..])\n    .enter().append("rect")\n    .attr("x",\n        (d, i) ->\n            return i * 20)\n    .attr("y",\n        (d, i) ->\n            return d.start*10)\n    .attr("height",\n            (d, i) ->\n                return (d.end.getHour() - d.start.getHour()) * 10)\n    .attr("width", 20)';


}).call(this);
